<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>e678366a67f54ac680e75b4f0ad9810f</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="9W6RU46B6VZ9">
<h1>DELE CA1 Part B</h1>
<h2>Name         : Isaac low zu le</h2>
<h2>class        : DAAA/FT/2A/03</h2>
<h2>admin number : P2342348</h2>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="H_xD2HJDudtS" data-outputId="b4479ce6-a74b-499a-c6f7-2a92680abbbe">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer, PorterStemmer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.text <span class="im">import</span> Tokenizer</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.sequence <span class="im">import</span> pad_sequences</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Embedding, SimpleRNN, Dense, Flatten</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.callbacks <span class="im">import</span> EarlyStopping</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> deep_translator <span class="im">import</span> GoogleTranslator</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> h5py</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> deep_translator <span class="im">import</span> GoogleTranslator</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.corpus <span class="im">import</span> stopwords</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> PorterStemmer</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure necessary NLTK data packages are downloaded</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;punkt&#39;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;stopwords&#39;</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>nltk.download(<span class="st">&#39;wordnet&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>[nltk_data] Downloading package punkt to /root/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package stopwords to /root/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to /root/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
</code></pre>
</div>
<div class="output execute_result" data-execution_count="1">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2" id="xFjhdzeVhyCb">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/MyDrive/Movie reviews.csv&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell markdown" id="F6LiPB6l4m6H">
<h3>lets do some text-based analysis to see how the dataset looks like</h3>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="yxBiw-tr4mOD" data-outputId="5424345d-158e-4d86-9b07-265a17cfe967">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df.info()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;First 5 rows of the Dataframe:&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.head(), end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Missing Values in Dataframe:&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>(), end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 527 entries, 0 to 526
Data columns (total 4 columns):
 #   Column                                                                                 Non-Null Count  Dtype  
---  ------                                                                                 --------------  -----  
 0   Review                                                                                 527 non-null    object 
 1   Score                                                                                  525 non-null    float64
 2   Are there ways for you to generate more data? Spliting up sentences, would that help?  0 non-null      float64
 3   Language                                                                               527 non-null    object 
dtypes: float64(2), object(2)
memory usage: 16.6+ KB


First 5 rows of the Dataframe:
                                              Review  Score  \
0  Filem ini hebat! Aksi yang mendebarkan dan plo...    0.1   
1  Filem ini hebat! Aksi yang mendebarkan dan plo...    0.9   
2  Filem ini hebat! Aksi yang mendebarkan dan plo...    0.5   
3  Sayang sekali, pelakon tidak memberikan persem...    0.8   
4  Jalan cerita yang kompleks dan penuh emosi. Su...    0.2   

   Are there ways for you to generate more data? Spliting up sentences, would that help?  \
0                                                NaN                                       
1                                                NaN                                       
2                                                NaN                                       
3                                                NaN                                       
4                                                NaN                                       

  Language  
0    Malay  
1    Malay  
2    Malay  
3    Malay  
4    Malay  


Missing Values in Dataframe:
Review                                                                                     0
Score                                                                                      2
Are there ways for you to generate more data? Spliting up sentences, would that help?    527
Language                                                                                   0
dtype: int64


</code></pre>
</div>
</div>
<div class="cell markdown" id="vM2T04-PGJ6z">
<p>Since column "Are there ways for you to generate more data? Spliting
up sentences, would that help?" does not contain any non- null values, i
will be dropping it. since there are only two missing values in column
Score, i will be dropping them too</p>
</div>
<div class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="J4GkGdyIG-xL" data-outputId="bfc1944e-45f8-4da3-b320-31a301610924">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.drop(<span class="st">&quot;Are there ways for you to generate more data? Spliting up sentences, would that help?&quot;</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.dropna()</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Missing Values in Dataframe:&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>(), end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Different Languages present in Dataframe: &quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">&quot;Language&quot;</span>].value_counts(),end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Missing Values in Dataframe:
Review      0
Score       0
Language    0
dtype: int64


Different Languages present in Dataframe: 
Language
English    297
Malay      226
Chinese      1
Nippon       1
Name: count, dtype: int64


&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Index: 525 entries, 0 to 526
Data columns (total 3 columns):
 #   Column    Non-Null Count  Dtype  
---  ------    --------------  -----  
 0   Review    525 non-null    object 
 1   Score     525 non-null    float64
 2   Language  525 non-null    object 
dtypes: float64(1), object(2)
memory usage: 16.4+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="2v1Zc3fd_H0R" data-outputId="63b663b5-aaa1-45a3-de85-a0e82fcd014b">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[df[<span class="st">&quot;Language&quot;</span>] <span class="op">==</span> <span class="st">&#39;Chinese&#39;</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                    Review  Score Language
427  Hen tai fei chang hao  0.001  Chinese
</code></pre>
</div>
</div>
<div class="cell markdown" id="UbZgcq-oH4Sz">

</div>
<div class="cell code" data-execution_count="6"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:765}"
id="0UMHSPG_6eJN" data-outputId="23fcd6d4-6886-4405-c418-3026a2f62afc">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Divide the &#39;Score&#39; column into three classes</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="fl">0.33</span>, <span class="fl">0.66</span>, <span class="dv">1</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;positive&#39;</span>, <span class="st">&#39;neutral&#39;</span>, <span class="st">&#39;negative&#39;</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Sentiment&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;Score&#39;</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, include_lowest<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the histogram of the &#39;Sentiment&#39; column</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Sentiment&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, title<span class="op">=</span><span class="st">&#39;Sentiment&#39;</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/a1f2fd387e11928ce8088b231800bb05b8200960.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="ffSPFIRN8cxL" data-outputId="bec83279-af6a-40b7-b22f-e98f4a119ac6">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>(), end<span class="op">=</span><span class="st">&quot;</span><span class="ch">\n\n\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Review       0
Score        0
Language     0
Sentiment    0
dtype: int64


</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:717}"
id="ddOCnFHMvaNx" data-outputId="a49f6efd-4fca-4a5d-d614-2b1f964b953d">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>df.groupby(<span class="st">&#39;Language&#39;</span>).size().plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Rows by language&quot;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.gca().spines[[&#39;top&#39;, &#39;right&#39;,]].set_visible(False)</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>Text(0.5, 1.0, &#39;Rows by language&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/ae235af45746b97d0f62ececcc8fc517406882ec.png" /></p>
</div>
</div>
<div class="cell markdown" id="wSV85x-NmLR0">
<p>Since there is only one chinese and one nippon entry, i will be
dropping them</p>
</div>
<div class="cell code" data-execution_count="9" id="cAYD2OQoDB3E">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>values_to_drop <span class="op">=</span> [<span class="st">&#39;Chinese&#39;</span>, <span class="st">&#39;Nippon&#39;</span>]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[<span class="op">~</span>df[<span class="st">&#39;Language&#39;</span>].isin(values_to_drop)]</span></code></pre></div>
</div>
<div class="cell markdown" id="Gi5CUzb6bM48">
<h3>now that we have analysed the dataset and cleaned up the data, we will proceed to data augmentation and preprocessing</h3>
</div>
<div class="cell code" data-execution_count="10"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="fkdkm9XZa6--" data-outputId="76bed630-ad90-41c1-bbbc-efccc7848a72">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="10">

  <div id="df-345634a9-7bc4-4873-9383-2c11442cbb07" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Review</th>
      <th>Score</th>
      <th>Language</th>
      <th>Sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.9</td>
      <td>Malay</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.5</td>
      <td>Malay</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sayang sekali, pelakon tidak memberikan persem...</td>
      <td>0.8</td>
      <td>Malay</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jalan cerita yang kompleks dan penuh emosi. Su...</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>522</th>
      <td>Pening</td>
      <td>0.7</td>
      <td>Malay</td>
      <td>negative</td>
    </tr>
    <tr>
      <th>523</th>
      <td>Berkesan</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>524</th>
      <td>Mengujakan</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
    </tr>
    <tr>
      <th>525</th>
      <td>Sederhana and teruk</td>
      <td>0.6</td>
      <td>Malay</td>
      <td>neutral</td>
    </tr>
    <tr>
      <th>526</th>
      <td>Sempurna</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
    </tr>
  </tbody>
</table>
<p>523 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-345634a9-7bc4-4873-9383-2c11442cbb07')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-345634a9-7bc4-4873-9383-2c11442cbb07 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-345634a9-7bc4-4873-9383-2c11442cbb07');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b9bec671-42bf-480f-bacb-da5a9ba2319d">
  <button class="colab-df-quickchart" onclick="quickchart('df-b9bec671-42bf-480f-bacb-da5a9ba2319d')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b9bec671-42bf-480f-bacb-da5a9ba2319d button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="11" id="8YIZOCRjWzgQ">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_text(text, language):</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pd.isna(text):</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> language.lower() <span class="op">!=</span> <span class="st">&#39;english&#39;</span>:</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Translate to English</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        text <span class="op">=</span> GoogleTranslator(source<span class="op">=</span><span class="st">&#39;auto&#39;</span>, target<span class="op">=</span><span class="st">&#39;en&#39;</span>).translate(text)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> word_tokenize(text)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter out punctuation marks</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> [token <span class="cf">for</span> token <span class="kw">in</span> tokens <span class="cf">if</span> token.isalnum()]</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    stop_words <span class="op">=</span> <span class="bu">set</span>(stopwords.words(<span class="st">&#39;english&#39;</span>))</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lemmatize and remove stop words</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> [lemmatizer.lemmatize(token.lower()) <span class="cf">for</span> token <span class="kw">in</span> tokens <span class="cf">if</span> token.lower() <span class="kw">not</span> <span class="kw">in</span> stop_words]</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Join the tokens back into a single string</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    processed_text <span class="op">=</span> <span class="st">&#39; &#39;</span>.join(tokens)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> processed_text</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your DataFrame is named &#39;df&#39;</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Processed_Text&#39;</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: process_text(row[<span class="st">&#39;Review&#39;</span>], row[<span class="st">&#39;Language&#39;</span>]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="j9h3bHe1eRV0" data-outputId="54610a99-e2a6-4eba-854e-29c6851c612d">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">

  <div id="df-d80d0c9d-3d71-4420-a2c9-d2899904f64d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Review</th>
      <th>Score</th>
      <th>Language</th>
      <th>Sentiment</th>
      <th>Processed_Text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>movie great thrilling action surprising plot</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.9</td>
      <td>Malay</td>
      <td>negative</td>
      <td>movie great thrilling action surprising plot</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.5</td>
      <td>Malay</td>
      <td>neutral</td>
      <td>movie great thrilling action surprising plot</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sayang sekali, pelakon tidak memberikan persem...</td>
      <td>0.8</td>
      <td>Malay</td>
      <td>negative</td>
      <td>bad actor give best performance satisfied</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jalan cerita yang kompleks dan penuh emosi. Su...</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
      <td>complex emotional storyline really entertaining</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>522</th>
      <td>Pening</td>
      <td>0.7</td>
      <td>Malay</td>
      <td>negative</td>
      <td>dizziness</td>
    </tr>
    <tr>
      <th>523</th>
      <td>Berkesan</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
      <td>effective</td>
    </tr>
    <tr>
      <th>524</th>
      <td>Mengujakan</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>exciting</td>
    </tr>
    <tr>
      <th>525</th>
      <td>Sederhana and teruk</td>
      <td>0.6</td>
      <td>Malay</td>
      <td>neutral</td>
      <td>simple bad</td>
    </tr>
    <tr>
      <th>526</th>
      <td>Sempurna</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>perfect</td>
    </tr>
  </tbody>
</table>
<p>523 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d80d0c9d-3d71-4420-a2c9-d2899904f64d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d80d0c9d-3d71-4420-a2c9-d2899904f64d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d80d0c9d-3d71-4420-a2c9-d2899904f64d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-edcbca1b-f1d5-49df-a969-3335670bf602">
  <button class="colab-df-quickchart" onclick="quickchart('df-edcbca1b-f1d5-49df-a969-3335670bf602')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-edcbca1b-f1d5-49df-a969-3335670bf602 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="13" id="rm422KrfAaDZ">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a Tokenizer instance</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>tokenizer <span class="op">=</span> Tokenizer()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the tokenizer on the processed text</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>tokenizer.fit_on_texts(df[<span class="st">&#39;Processed_Text&#39;</span>])</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the processed text to sequences of integers</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> tokenizer.texts_to_sequences(df[<span class="st">&#39;Processed_Text&#39;</span>])</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>word_index <span class="op">=</span> tokenizer.word_index</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>vocab_size <span class="op">=</span> <span class="bu">len</span>(word_index) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Pad the sequences to a fixed length</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="bu">max</span>([<span class="bu">len</span>(seq) <span class="cf">for</span> seq <span class="kw">in</span> sequences])</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>padded_sequences <span class="op">=</span> pad_sequences(sequences, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new DataFrame with the padded sequences</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>padded_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Padded_Sequences&#39;</span>: padded_sequences.tolist()})</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([df, padded_df], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="SaiLm9PNfajT" data-outputId="8255201a-7384-4bdc-c985-77ffa59dfdfd">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="14">

  <div id="df-4a4333f8-65c5-428c-bae0-f7a389f9c0a9" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Review</th>
      <th>Score</th>
      <th>Language</th>
      <th>Sentiment</th>
      <th>Processed_Text</th>
      <th>Padded_Sequences</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.9</td>
      <td>Malay</td>
      <td>negative</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.5</td>
      <td>Malay</td>
      <td>neutral</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sayang sekali, pelakon tidak memberikan persem...</td>
      <td>0.8</td>
      <td>Malay</td>
      <td>negative</td>
      <td>bad actor give best performance satisfied</td>
      <td>[150, 16, 131, 447, 14, 216, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jalan cerita yang kompleks dan penuh emosi. Su...</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
      <td>complex emotional storyline really entertaining</td>
      <td>[39, 10, 30, 83, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>526</th>
      <td>Sempurna</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>perfect</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>426</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[124, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>427</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>
    </tr>
    <tr>
      <th>484</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[445, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>
    </tr>
    <tr>
      <th>493</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>[23, 19, 37, 54, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
  </tbody>
</table>
<p>527 rows × 6 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4a4333f8-65c5-428c-bae0-f7a389f9c0a9')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4a4333f8-65c5-428c-bae0-f7a389f9c0a9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4a4333f8-65c5-428c-bae0-f7a389f9c0a9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d10b1cec-54c8-4f8b-a24a-fe9bcf9813f4">
  <button class="colab-df-quickchart" onclick="quickchart('df-d10b1cec-54c8-4f8b-a24a-fe9bcf9813f4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d10b1cec-54c8-4f8b-a24a-fe9bcf9813f4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="AIr2v0aVb7T6" data-outputId="415a709e-ea79-4749-c045-cb0b8ca74d36">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your DataFrame is named &#39;df&#39; and has the specified columns</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot frequency vs tokenized length</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>tokenized_lengths <span class="op">=</span> df[<span class="st">&#39;Processed_Text&#39;</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>tokenized_lengths.hist(bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Tokenized Length&#39;</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Frequency vs Tokenized Length&#39;</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot frequency vs review length</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>review_lengths <span class="op">=</span> df[<span class="st">&#39;Review&#39;</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>review_lengths.hist(bins<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Review Length&#39;</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Frequency vs Review Length&#39;</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/9525832ec16cd55ad634fc7ac104a899195fce20.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/13c28d98f5b56cb8b9eb25c0e1e5064608e3fba5.png" /></p>
</div>
</div>
<div class="cell markdown" id="hF_x_Od3f24T">
<p>here we can see how through lemmitization, we have managed to cut
down the number of words by alot</p>
</div>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="ssIvRt5bc3B7" data-outputId="f089bbd1-1b5f-4ef6-8196-086778cc49af">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.dropna()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-a5431617-679c-4cb0-bd4b-4d1ce7a02f0b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Review</th>
      <th>Score</th>
      <th>Language</th>
      <th>Sentiment</th>
      <th>Processed_Text</th>
      <th>Padded_Sequences</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.9</td>
      <td>Malay</td>
      <td>negative</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Filem ini hebat! Aksi yang mendebarkan dan plo...</td>
      <td>0.5</td>
      <td>Malay</td>
      <td>neutral</td>
      <td>movie great thrilling action surprising plot</td>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sayang sekali, pelakon tidak memberikan persem...</td>
      <td>0.8</td>
      <td>Malay</td>
      <td>negative</td>
      <td>bad actor give best performance satisfied</td>
      <td>[150, 16, 131, 447, 14, 216, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jalan cerita yang kompleks dan penuh emosi. Su...</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
      <td>complex emotional storyline really entertaining</td>
      <td>[39, 10, 30, 83, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>518</th>
      <td>Kembara epik</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>epic adventure</td>
      <td>[667, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>519</th>
      <td>Menakjubkan</td>
      <td>0.1</td>
      <td>Malay</td>
      <td>positive</td>
      <td>amazing</td>
      <td>[668, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>520</th>
      <td>Kacau bilau</td>
      <td>0.8</td>
      <td>Malay</td>
      <td>negative</td>
      <td>chaos</td>
      <td>[277, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
    <tr>
      <th>521</th>
      <td>Menawan hati</td>
      <td>0.2</td>
      <td>Malay</td>
      <td>positive</td>
      <td>captivating</td>
      <td>[669, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
    </tr>
    <tr>
      <th>522</th>
      <td>Pening</td>
      <td>0.7</td>
      <td>Malay</td>
      <td>negative</td>
      <td>dizziness</td>
      <td>[670, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
    </tr>
  </tbody>
</table>
<p>519 rows × 6 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a5431617-679c-4cb0-bd4b-4d1ce7a02f0b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a5431617-679c-4cb0-bd4b-4d1ce7a02f0b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a5431617-679c-4cb0-bd4b-4d1ce7a02f0b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3d8dd5de-ba2f-44b8-9cbd-1e3f3502cca3">
  <button class="colab-df-quickchart" onclick="quickchart('df-3d8dd5de-ba2f-44b8-9cbd-1e3f3502cca3')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3d8dd5de-ba2f-44b8-9cbd-1e3f3502cca3 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="17" id="OB2DVI0rQbTt">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>final_df <span class="op">=</span> df[[<span class="st">&#39;Sentiment&#39;</span>, <span class="st">&#39;Padded_Sequences&#39;</span>]]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18" id="RJlOgS-DWMdj">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>final_df <span class="op">=</span> pd.get_dummies(final_df, columns<span class="op">=</span>[<span class="st">&#39;Sentiment&#39;</span>])</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="8_6lkP4BX3s3" data-outputId="19865b84-4c23-4773-9cce-597cf2500a14">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>final_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="19">

  <div id="df-5d1340da-c518-41b3-b4ac-868ab55ed11d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Padded_Sequences</th>
      <th>Sentiment_positive</th>
      <th>Sentiment_neutral</th>
      <th>Sentiment_negative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[150, 16, 131, 447, 14, 216, 0, 0, 0, 0, 0, 0,...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[39, 10, 30, 83, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>518</th>
      <td>[667, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>519</th>
      <td>[668, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>520</th>
      <td>[277, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
    <tr>
      <th>521</th>
      <td>[669, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>522</th>
      <td>[670, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>519 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5d1340da-c518-41b3-b4ac-868ab55ed11d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5d1340da-c518-41b3-b4ac-868ab55ed11d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5d1340da-c518-41b3-b4ac-868ab55ed11d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ab424cd5-34d0-4342-9009-8f8a13b2068c">
  <button class="colab-df-quickchart" onclick="quickchart('df-ab424cd5-34d0-4342-9009-8f8a13b2068c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ab424cd5-34d0-4342-9009-8f8a13b2068c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="20" id="NX2eDawuX1GD">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>final_df[[<span class="st">&#39;Sentiment_positive&#39;</span>, <span class="st">&#39;Sentiment_neutral&#39;</span>, <span class="st">&#39;Sentiment_negative&#39;</span>]] <span class="op">=</span> final_df[[<span class="st">&#39;Sentiment_positive&#39;</span>, <span class="st">&#39;Sentiment_neutral&#39;</span>, <span class="st">&#39;Sentiment_negative&#39;</span>]].astype(<span class="bu">int</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
id="tA9B6HUqZRRl" data-outputId="ca0f90b9-ccc5-4941-ca6f-4b40393d55ef">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>final_df</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">

  <div id="df-e4473779-cc51-4565-b542-ce95f3ae80cc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Padded_Sequences</th>
      <th>Sentiment_positive</th>
      <th>Sentiment_neutral</th>
      <th>Sentiment_negative</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[4, 27, 32, 3, 104, 2, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[150, 16, 131, 447, 14, 216, 0, 0, 0, 0, 0, 0,...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[39, 10, 30, 83, 95, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>518</th>
      <td>[667, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>519</th>
      <td>[668, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>520</th>
      <td>[277, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>521</th>
      <td>[669, 150, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>522</th>
      <td>[670, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>519 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e4473779-cc51-4565-b542-ce95f3ae80cc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e4473779-cc51-4565-b542-ce95f3ae80cc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e4473779-cc51-4565-b542-ce95f3ae80cc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c47f99b3-1aca-4f87-a38c-dcc6d9cb12aa">
  <button class="colab-df-quickchart" onclick="quickchart('df-c47f99b3-1aca-4f87-a38c-dcc6d9cb12aa')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c47f99b3-1aca-4f87-a38c-dcc6d9cb12aa button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="22" id="NY7ShHARZwXs">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_df[<span class="st">&#39;Padded_Sequences&#39;</span>].tolist()</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_df[[<span class="st">&#39;Sentiment_positive&#39;</span>, <span class="st">&#39;Sentiment_neutral&#39;</span>, <span class="st">&#39;Sentiment_negative&#39;</span>]].values</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.eye(<span class="dv">3</span>)[np.argmax(y, axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="0ki_AT0VrmoA" data-outputId="f8e89b12-92fb-40f2-d329-6aa983be5372">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each class</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>unique_labels, counts <span class="op">=</span> np.unique(np.array(y), axis<span class="op">=</span><span class="dv">0</span>, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to map the labels</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>label_map <span class="op">=</span> {</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[1. 0. 0.]&#39;</span>: <span class="st">&#39;Positive&#39;</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 1. 0.]&#39;</span>: <span class="st">&#39;Neutral&#39;</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 0. 1.]&#39;</span>: <span class="st">&#39;Negative&#39;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [label_map.get(<span class="bu">str</span>(label), <span class="bu">str</span>(label)) <span class="cf">for</span> label <span class="kw">in</span> unique_labels]</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>plt.pie(counts, labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Classes&#39;</span>)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/8cf2aca8af601e6d5d0dc3c327401548778bb63c.png" /></p>
</div>
</div>
<div class="cell markdown" id="7ZXsLQ67s77o">
<p>here we can see that the dataset is super unbalanced with
overwhelmingly positive data. This is not very good as it may cause the
model to becoemme biased. therefore, i will try and equalize the classes
in my training set</p>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="JKN_d2aZZxii" data-outputId="0b489afd-32ae-4a8d-d283-af34b0e61e7b">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(519, 34)
(519, 3)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24" id="jY9CUm1juHNj">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="25" id="UbUmS-JgjOa9">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X_train, y_train, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="26" id="ECI1Zn0nuKZC">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Embedding, Flatten, Dense</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.sequence <span class="im">import</span> pad_sequences</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming top_words is the size of your vocabulary</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>top_words <span class="op">=</span> vocab_size</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>max_words <span class="op">=</span> <span class="dv">34</span>  <span class="co"># Maximum sequence length</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model(vocab_size, max_words):</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    model.add(Embedding(vocab_size, <span class="dv">32</span>, input_length<span class="op">=</span>max_words))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    model.add(Flatten())</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">250</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>))  <span class="co"># Output layer with 3 classes and softmax activation</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>, optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="27" id="s7wwUbiLxHGI">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_accuracy_loss(history):</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the accuracy</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    plt.plot(history.history[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(history.history[<span class="st">&#39;val_accuracy&#39;</span>])</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Model Accuracy&#39;</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    plt.legend([<span class="st">&#39;Train&#39;</span>, <span class="st">&#39;Validation&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the loss</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    plt.plot(history.history[<span class="st">&#39;loss&#39;</span>])</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    plt.plot(history.history[<span class="st">&#39;val_loss&#39;</span>])</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Model Loss&#39;</span>)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Loss&#39;</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Epoch&#39;</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    plt.legend([<span class="st">&#39;Train&#39;</span>, <span class="st">&#39;Validation&#39;</span>], loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code></pre></div>
</div>
<div class="cell markdown" id="J2z1JD4suSwV">
<p>here, we will try training our model once to establish a baseline to
work off of</p>
</div>
<div class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="td4u7UI2uXS0" data-outputId="830f3070-0312-41c1-cde3-164083f8d315">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># implement early stopping</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>earlyStopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">&quot;val_loss&quot;</span>, patience<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> create_model(vocab_size, max_words)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, validation_data<span class="op">=</span>(X_val, y_val), epochs<span class="op">=</span><span class="dv">30</span>, batch_size<span class="op">=</span><span class="dv">32</span>, callbacks<span class="op">=</span>[earlyStopping])</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>plot_accuracy_loss(history)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/30
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>10/10 ━━━━━━━━━━━━━━━━━━━━ 3s 153ms/step - accuracy: 0.5077 - loss: 1.0047 - val_accuracy: 0.7981 - val_loss: 0.6939
Epoch 2/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.6400 - loss: 0.8920 - val_accuracy: 0.7981 - val_loss: 0.7377
Epoch 3/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.6832 - loss: 0.7853 - val_accuracy: 0.7981 - val_loss: 0.6299
Epoch 4/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.6642 - loss: 0.7607 - val_accuracy: 0.8173 - val_loss: 0.6105
Epoch 5/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.7261 - loss: 0.6129 - val_accuracy: 0.8462 - val_loss: 0.4909
Epoch 6/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.8431 - loss: 0.4704 - val_accuracy: 0.8750 - val_loss: 0.4394
Epoch 7/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.8645 - loss: 0.3708 - val_accuracy: 0.8750 - val_loss: 0.3561
Epoch 8/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.8909 - loss: 0.2654 - val_accuracy: 0.8942 - val_loss: 0.3217
Epoch 9/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9116 - loss: 0.2288 - val_accuracy: 0.9038 - val_loss: 0.2818
Epoch 10/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9281 - loss: 0.1924 - val_accuracy: 0.9231 - val_loss: 0.2813
Epoch 11/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9459 - loss: 0.1565 - val_accuracy: 0.9231 - val_loss: 0.2579
Epoch 12/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 6ms/step - accuracy: 0.9668 - loss: 0.1026 - val_accuracy: 0.9231 - val_loss: 0.2708
Epoch 13/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9740 - loss: 0.0958 - val_accuracy: 0.9327 - val_loss: 0.2540
Epoch 14/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9655 - loss: 0.1077 - val_accuracy: 0.9135 - val_loss: 0.2663
Epoch 15/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.9715 - loss: 0.0891 - val_accuracy: 0.9231 - val_loss: 0.2680
Epoch 16/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 4ms/step - accuracy: 0.9759 - loss: 0.0782 - val_accuracy: 0.9038 - val_loss: 0.2616
Epoch 17/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9892 - loss: 0.0522 - val_accuracy: 0.9231 - val_loss: 0.2762
Epoch 18/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 5ms/step - accuracy: 0.9648 - loss: 0.0724 - val_accuracy: 0.9327 - val_loss: 0.2775
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/61d25c040914438fd503b806ef8f2d9f4f388031.png" /></p>
</div>
</div>
<div class="cell markdown" id="Xlc7dOnjwWQN">
<p>here we can seeee that our preliminary model achieved<br> val_loss:
0.2527 - val_accuracy: 0.9231 <br> lets see if oversampling improves the
data</p>
</div>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="e65-0ROtsSeF" data-outputId="acab983d-4027-4906-d65f-e5edc15e4bf0">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each class</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>unique_labels, counts <span class="op">=</span> np.unique(np.array(y_train), axis<span class="op">=</span><span class="dv">0</span>, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to map the labels</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>label_map <span class="op">=</span> {</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[1. 0. 0.]&#39;</span>: <span class="st">&#39;Positive&#39;</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 1. 0.]&#39;</span>: <span class="st">&#39;Neutral&#39;</span>,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 0. 1.]&#39;</span>: <span class="st">&#39;Negative&#39;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [label_map.get(<span class="bu">str</span>(label), <span class="bu">str</span>(label)) <span class="cf">for</span> label <span class="kw">in</span> unique_labels]</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>plt.pie(counts, labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Classes&#39;</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/687dc36c5d1671c4a35f463b4d84cb6b1588183b.png" /></p>
</div>
</div>
<div class="cell code" id="KsAug712rL_X">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<div class="cell code" data-execution_count="31" id="UWcLtnlXi5kL">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils <span class="im">import</span> resample</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.preprocessing.sequence <span class="im">import</span> pad_sequences</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the indices of the negative, neutral, and positive classes in the training labels</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>negative_indices <span class="op">=</span> np.where(y_train[:, <span class="dv">0</span>] <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>neutral_indices <span class="op">=</span> np.where(y_train[:, <span class="dv">1</span>] <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>positive_indices <span class="op">=</span> np.where(y_train[:, <span class="dv">2</span>] <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the target size for each class as the maximum of the class lengths</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>target_size <span class="op">=</span> <span class="bu">max</span>(<span class="bu">len</span>(negative_indices), <span class="bu">len</span>(neutral_indices), <span class="bu">len</span>(positive_indices))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Upsample the negative and neutral classes to the target size using resample()</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>negative_upsampled, negative_labels <span class="op">=</span> resample(X_train[negative_indices], y_train[negative_indices], replace<span class="op">=</span><span class="va">True</span>, n_samples<span class="op">=</span>target_size, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>neutral_upsampled, neutral_labels <span class="op">=</span> resample(X_train[neutral_indices], y_train[neutral_indices], replace<span class="op">=</span><span class="va">True</span>, n_samples<span class="op">=</span>target_size, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>positive_upsampled, positive_labels <span class="op">=</span> resample(X_train[positive_indices], y_train[positive_indices], replace<span class="op">=</span><span class="va">True</span>, n_samples<span class="op">=</span>target_size, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the maximum length among the original and upsampled sequences</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>max_length <span class="op">=</span> <span class="bu">max</span>(X_train.shape[<span class="dv">1</span>], negative_upsampled.shape[<span class="dv">1</span>], neutral_upsampled.shape[<span class="dv">1</span>], positive_upsampled.shape[<span class="dv">1</span>])</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Pad the original and upsampled sequences to the max_length using post padding</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>X_train_padded <span class="op">=</span> pad_sequences(X_train, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>negative_padded <span class="op">=</span> pad_sequences(negative_upsampled, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>neutral_padded <span class="op">=</span> pad_sequences(neutral_upsampled, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>positive_padded <span class="op">=</span> pad_sequences(positive_upsampled, maxlen<span class="op">=</span>max_length, padding<span class="op">=</span><span class="st">&#39;post&#39;</span>)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate the original and upsampled data to create the expanded datasets</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>X_expanded <span class="op">=</span> np.concatenate([X_train_padded, negative_padded, neutral_padded, positive_padded], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>y_expanded <span class="op">=</span> np.concatenate([y_train, negative_labels, neutral_labels, positive_labels], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffle the expanded datasets using random permutation</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>shuffle_indices <span class="op">=</span> np.random.permutation(<span class="bu">len</span>(X_expanded))</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_expanded[shuffle_indices]</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> y_expanded[shuffle_indices]</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>X_train_oversampled_backup<span class="op">=</span>X_train</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>y_train_oversampled_backup<span class="op">=</span>y_train</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train=X_train_oversampled_backup</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a><span class="co"># y_train=y_train_oversampled_backup</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:526}"
id="ZQCSPT_wsZT6" data-outputId="4fdab539-a1c9-4ed4-be52-4661a03f764b">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the occurrences of each class</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>unique_labels, counts <span class="op">=</span> np.unique(np.array(y_train), axis<span class="op">=</span><span class="dv">0</span>, return_counts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dictionary to map the labels</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>label_map <span class="op">=</span> {</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[1. 0. 0.]&#39;</span>: <span class="st">&#39;Positive&#39;</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 1. 0.]&#39;</span>: <span class="st">&#39;Neutral&#39;</span>,</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;[0. 0. 1.]&#39;</span>: <span class="st">&#39;Negative&#39;</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [label_map.get(<span class="bu">str</span>(label), <span class="bu">str</span>(label)) <span class="cf">for</span> label <span class="kw">in</span> unique_labels]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>plt.pie(counts, labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Classes&#39;</span>)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/6f5f9b45700caa75e98042ada98673a030592754.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="Up_ECB7jysgr" data-outputId="94479469-8ebd-44f3-8b15-c5d53357a5ac">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(935, 3)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:935}"
id="Au7G89jMt7rS" data-outputId="5a9965af-3c24-4eb7-df67-1aa2b7832ea4">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># implement early stopping</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>earlyStopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">&quot;val_loss&quot;</span>, patience<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> create_model(vocab_size, max_words)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, validation_data<span class="op">=</span>(X_val, y_val), epochs<span class="op">=</span><span class="dv">30</span>, batch_size<span class="op">=</span><span class="dv">32</span>, callbacks<span class="op">=</span>[earlyStopping])</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>plot_accuracy_loss(history)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 2s 35ms/step - accuracy: 0.4933 - loss: 1.0481 - val_accuracy: 0.8365 - val_loss: 0.6640
Epoch 2/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.7841 - loss: 0.6704 - val_accuracy: 0.9135 - val_loss: 0.3545
Epoch 3/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9272 - loss: 0.2428 - val_accuracy: 0.9135 - val_loss: 0.2830
Epoch 4/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9768 - loss: 0.1041 - val_accuracy: 0.9231 - val_loss: 0.2646
Epoch 5/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9866 - loss: 0.0675 - val_accuracy: 0.9231 - val_loss: 0.2856
Epoch 6/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9829 - loss: 0.0526 - val_accuracy: 0.9135 - val_loss: 0.2647
Epoch 7/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9784 - loss: 0.0430 - val_accuracy: 0.9135 - val_loss: 0.2870
Epoch 8/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9877 - loss: 0.0361 - val_accuracy: 0.9231 - val_loss: 0.2909
Epoch 9/30
30/30 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9891 - loss: 0.0316 - val_accuracy: 0.9135 - val_loss: 0.3108
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/7a59630331c02dcb6c8da4791df4dee03d65065f.png" /></p>
</div>
</div>
<div class="cell markdown" id="C1N1Cy2VycQx">
<p>without oversampling:<br> val_accuracy: 0.9327 - val_loss: 0.2775
<br> with:<br> val_accuracy: 0.9135 - val_loss: 0.3108<br> oversampling
does not have a really large positive impact</p>
</div>
<div class="cell markdown" id="Zq-K1z_X0Q84">
<p>now i will try adding layers to see if it improves accuracy</p>
</div>
<div class="cell code" data-execution_count="36" id="8H9RDf5Kj8cQ">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.models <span class="im">import</span> Sequential</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras.layers <span class="im">import</span> Embedding, Flatten, Dense, GRU, LSTM, TimeDistributed</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model(vocab_size, max_words):</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    model.add(Embedding(vocab_size, <span class="dv">32</span>, input_length<span class="op">=</span>max_words))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a GRU layer</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    model.add(GRU(<span class="dv">64</span>, return_sequences<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    model.add(GRU(<span class="dv">32</span>))</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">250</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>))  <span class="co"># Output layer with 3 classes and softmax activation</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>, optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="50" id="lzPe7czr03C8">
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train=X_train_oversampled_backup</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y_train=y_train_oversampled_backup</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_df[<span class="st">&#39;Padded_Sequences&#39;</span>].tolist()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_df[[<span class="st">&#39;Sentiment_positive&#39;</span>, <span class="st">&#39;Sentiment_neutral&#39;</span>, <span class="st">&#39;Sentiment_negative&#39;</span>]].values</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.eye(<span class="dv">3</span>)[np.argmax(y, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> train_test_split(X_train, y_train, test_size<span class="op">=</span><span class="fl">0.25</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:899}"
id="TOgugMpk2EGX" data-outputId="e701d59c-dd12-4f24-9f0c-c71cb3f2c006">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># implement early stopping</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>earlyStopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">&quot;val_loss&quot;</span>, patience<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> create_model(vocab_size, max_words)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, validation_data<span class="op">=</span>(X_val, y_val), epochs<span class="op">=</span><span class="dv">30</span>, batch_size<span class="op">=</span><span class="dv">32</span>, callbacks<span class="op">=</span>[earlyStopping])</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>plot_accuracy_loss(history)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/30
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>10/10 ━━━━━━━━━━━━━━━━━━━━ 4s 44ms/step - accuracy: 0.5347 - loss: 1.0679 - val_accuracy: 0.7981 - val_loss: 0.8090
Epoch 2/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - accuracy: 0.6731 - loss: 0.8819 - val_accuracy: 0.7981 - val_loss: 0.6580
Epoch 3/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - accuracy: 0.6723 - loss: 0.8427 - val_accuracy: 0.7981 - val_loss: 0.7285
Epoch 4/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - accuracy: 0.6521 - loss: 0.8834 - val_accuracy: 0.7981 - val_loss: 0.6866
Epoch 5/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 10ms/step - accuracy: 0.6690 - loss: 0.8564 - val_accuracy: 0.7981 - val_loss: 0.6583
Epoch 6/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - accuracy: 0.6485 - loss: 0.8833 - val_accuracy: 0.7981 - val_loss: 0.7026
Epoch 7/30
10/10 ━━━━━━━━━━━━━━━━━━━━ 0s 12ms/step - accuracy: 0.6777 - loss: 0.8338 - val_accuracy: 0.7981 - val_loss: 0.6756
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/eb5a2ebf1f67245ef7f5b3cfa008cf1dbea4b0ff.png" /></p>
</div>
</div>
<div class="cell markdown" id="pxQ23YhL3kIx">
<p>this new model has a very poor performance, mmaybe we can help it
with hyperparameter tuning without oversampling:<br> val_accuracy:
0.9327 - val_loss: 0.2775 <br> with:<br> val_accuracy: 0.9135 -
val_loss: 0.3108<br> GRU:<br> val_accuracy: 0.7981 - val_loss:
0.6756<br></p>
</div>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="6ztT3rYUGNib" data-outputId="187f5564-8b0c-4de3-afc5-6c5c399e288d">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_train.shape)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_train.shape)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_val.shape)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_val.shape)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(311, 34)
(311, 3)
(104, 34)
(104, 3)
</code></pre>
</div>
</div>
<div class="cell markdown" id="qFuoPUVl4YXU">
<h1>Hyperparameter tuning</h1>
<p>now i will be moving on to hyperparameter tuning to improve my
model's characteristics</p>
</div>
<div class="cell code" data-execution_count="102" id="bEIqyH2zAJGG">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X_train=X_train_oversampled_backup</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y_train=y_train_oversampled_backup</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> final_df[<span class="st">&#39;Padded_Sequences&#39;</span>].tolist()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(X)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> final_df[[<span class="st">&#39;Sentiment_positive&#39;</span>, <span class="st">&#39;Sentiment_neutral&#39;</span>, <span class="st">&#39;Sentiment_negative&#39;</span>]].values</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.eye(<span class="dv">3</span>)[np.argmax(y, axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="76"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="JyxZc_QYAM7f" data-outputId="1f91b570-91fd-482b-c62b-c80753017ad4">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scikeras.wrappers <span class="im">import</span> KerasClassifier</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model(neuron<span class="op">=</span><span class="dv">32</span>):</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    model.add(Embedding(<span class="dv">671</span>, <span class="dv">32</span>, input_length<span class="op">=</span><span class="dv">34</span>))</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add a GRU layer</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    model.add(GRU(neuron, return_sequences<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    model.add(GRU(<span class="dv">32</span>))</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">250</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>))  <span class="co"># Output layer with 3 classes and softmax activation</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>, optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;neuron&#39;</span>:[<span class="dv">16</span>,<span class="dv">32</span>,<span class="dv">64</span>,<span class="dv">128</span>,<span class="dv">256</span>]</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>random_search <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>KerasClassifier(model<span class="op">=</span>create_model, epochs<span class="op">=</span><span class="dv">10</span>, batch_size<span class="op">=</span><span class="dv">32</span>, verbose<span class="op">=</span><span class="dv">0</span>, neuron<span class="op">=</span><span class="dv">16</span>),</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    param_distributions<span class="op">=</span>param_grid,</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    n_iter<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">2</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>random_search.fit(X_train, y_train, validation_data<span class="op">=</span>(X_val, y_val))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Fitting 3 folds for each of 5 candidates, totalling 15 fits
[CV] END ..........................................neuron=16; total time=   0.0s
[CV] END ..........................................neuron=16; total time=   0.0s
[CV] END ..........................................neuron=16; total time=   0.0s
[CV] END ..........................................neuron=32; total time=   0.0s
[CV] END ..........................................neuron=32; total time=   0.0s
[CV] END ..........................................neuron=32; total time=   0.0s
[CV] END ..........................................neuron=64; total time=   0.0s
[CV] END ..........................................neuron=64; total time=   0.0s
[CV] END ..........................................neuron=64; total time=   0.0s
[CV] END .........................................neuron=128; total time=   0.0s
[CV] END .........................................neuron=128; total time=   0.0s
[CV] END .........................................neuron=128; total time=   0.0s
[CV] END .........................................neuron=256; total time=   0.0s
[CV] END .........................................neuron=256; total time=   0.0s
</code></pre>
</div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
/usr/local/lib/python3.10/dist-packages/keras/src/layers/core/embedding.py:90: UserWarning: Argument `input_length` is deprecated. Just remove it.
  warnings.warn(
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>[CV] END .........................................neuron=256; total time=   0.0s
</code></pre>
</div>
<div class="output error" data-ename="ValueError" data-evalue="
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score=&#39;raise&#39;.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_314&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_315&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_316&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_317&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_318&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_319&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_320&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_321&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_322&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_323&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_324&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_325&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_326&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_327&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_328&#39; has no defined outputs yet.
">
<pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-76-07599cbcde22&gt; in &lt;cell line: 32&gt;()
     30 )
     31 
---&gt; 32 random_search.fit(X_train, y_train, validation_data=(X_val, y_val))

/usr/local/lib/python3.10/dist-packages/sklearn/base.py in wrapper(estimator, *args, **kwargs)
   1472                 )
   1473             ):
-&gt; 1474                 return fit_method(estimator, *args, **kwargs)
   1475 
   1476         return wrapper

/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_search.py in fit(self, X, y, **params)
    968                 return results
    969 
--&gt; 970             self._run_search(evaluate_candidates)
    971 
    972             # multimetric is determined here because in the case of a callable

/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_search.py in _run_search(self, evaluate_candidates)
   1912     def _run_search(self, evaluate_candidates):
   1913         &quot;&quot;&quot;Search n_iter candidates from param_distributions&quot;&quot;&quot;
-&gt; 1914         evaluate_candidates(
   1915             ParameterSampler(
   1916                 self.param_distributions, self.n_iter, random_state=self.random_state

/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_search.py in evaluate_candidates(candidate_params, cv, more_results)
    945                     )
    946 
--&gt; 947                 _warn_or_raise_about_fit_failures(out, self.error_score)
    948 
    949                 # For callable self.scoring, the return type is only know after

/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py in _warn_or_raise_about_fit_failures(results, error_score)
    534                 f&quot;Below are more details about the failures:\n{fit_errors_summary}&quot;
    535             )
--&gt; 536             raise ValueError(all_fits_failed_message)
    537 
    538         else:

ValueError: 
All the 15 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score=&#39;raise&#39;.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_314&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_315&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_316&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_317&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_318&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_319&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_320&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_321&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_322&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_323&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_324&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_325&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_326&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_327&#39; has no defined outputs yet.

--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/sklearn/model_selection/_validation.py&quot;, line 895, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 1501, in fit
    super().fit(X=X, y=y, sample_weight=sample_weight, **kwargs)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 770, in fit
    self._fit(
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 936, in _fit
    self._check_model_compatibility(y)
  File &quot;/usr/local/lib/python3.10/dist-packages/scikeras/wrappers.py&quot;, line 559, in _check_model_compatibility
    if self.n_outputs_expected_ != len(self.model_.outputs):
  File &quot;/usr/local/lib/python3.10/dist-packages/keras/src/models/sequential.py&quot;, line 283, in outputs
    raise ValueError(
ValueError: Sequential model &#39;sequential_328&#39; has no defined outputs yet.

</code></pre>
</div>
</div>
<div class="cell markdown" id="UluK8_WTCdm6">
<p>in the end, the best model is the model we started with. lets see its
accuraccy against the test set</p>
</div>
<div class="cell code" data-execution_count="103" id="JyRZh4iHCrDT">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_model(vocab_size, max_words):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Sequential()</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    model.add(Embedding(vocab_size, <span class="dv">32</span>, input_length<span class="op">=</span>max_words))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    model.add(Flatten())</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">250</span>, activation<span class="op">=</span><span class="st">&#39;relu&#39;</span>))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    model.add(Dense(<span class="dv">3</span>, activation<span class="op">=</span><span class="st">&#39;softmax&#39;</span>))  <span class="co"># Output layer with 3 classes and softmax activation</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">&#39;categorical_crossentropy&#39;</span>, optimizer<span class="op">=</span><span class="st">&#39;adam&#39;</span>, metrics<span class="op">=</span>[<span class="st">&#39;accuracy&#39;</span>])</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="106"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:972}"
id="PPF9CTaFCycn" data-outputId="03a1f95b-da25-42bc-814b-473b649624b4">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="co"># implement early stopping</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>earlyStopping <span class="op">=</span> EarlyStopping(monitor<span class="op">=</span><span class="st">&quot;val_loss&quot;</span>, patience<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> create_model(vocab_size, max_words)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(X_train, y_train, validation_data<span class="op">=</span>(X_test, y_test), epochs<span class="op">=</span><span class="dv">30</span>, batch_size<span class="op">=</span><span class="dv">10</span>, callbacks<span class="op">=</span>[earlyStopping])</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>plot_accuracy_loss(history)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Epoch 1/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 2s 22ms/step - accuracy: 0.6509 - loss: 0.9044 - val_accuracy: 0.7019 - val_loss: 0.7701
Epoch 2/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.6914 - loss: 0.7262 - val_accuracy: 0.7596 - val_loss: 0.6208
Epoch 3/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.8313 - loss: 0.4526 - val_accuracy: 0.8173 - val_loss: 0.4734
Epoch 4/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9083 - loss: 0.2903 - val_accuracy: 0.8558 - val_loss: 0.4381
Epoch 5/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9387 - loss: 0.1636 - val_accuracy: 0.8462 - val_loss: 0.3948
Epoch 6/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9723 - loss: 0.0967 - val_accuracy: 0.8173 - val_loss: 0.3992
Epoch 7/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9647 - loss: 0.0950 - val_accuracy: 0.8365 - val_loss: 0.4223
Epoch 8/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9670 - loss: 0.0859 - val_accuracy: 0.8365 - val_loss: 0.4496
Epoch 9/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - accuracy: 0.9771 - loss: 0.0648 - val_accuracy: 0.8365 - val_loss: 0.4527
Epoch 10/30
42/42 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - accuracy: 0.9839 - loss: 0.0458 - val_accuracy: 0.8462 - val_loss: 0.5145
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_451d86714dce4e67b3b6469e9caacd24/3ef180ff06e8e2921bd7a2e627336b17cf36f90b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="113" id="RXpXC_xGDVvp">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>model.save_weights(<span class="st">&#39;model_rnn.weights.h5&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="87"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:273}"
id="oz6Pq_VHDmWb" data-outputId="7a2ccbea-3980-4689-8be0-c53b2a8f4de0">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code></pre></div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential_331"</span>
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                         </span>┃<span style="font-weight: bold"> Output Shape                </span>┃<span style="font-weight: bold">         Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ embedding_331 (<span style="color: #0087ff; text-decoration-color: #0087ff">Embedding</span>)            │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">34</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)              │          <span style="color: #00af00; text-decoration-color: #00af00">21,472</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ flatten_33 (<span style="color: #0087ff; text-decoration-color: #0087ff">Flatten</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1088</span>)                │               <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_662 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                    │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">250</span>)                 │         <span style="color: #00af00; text-decoration-color: #00af00">272,250</span> │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ dense_663 (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                    │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">3</span>)                   │             <span style="color: #00af00; text-decoration-color: #00af00">753</span> │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">883,427</span> (3.37 MB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">294,475</span> (1.12 MB)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>

</div>
<div class="output display_data">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Optimizer params: </span><span style="color: #00af00; text-decoration-color: #00af00">588,952</span> (2.25 MB)
</pre>

</div>
</div>
<div class="cell code" data-execution_count="110"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="6sCvFpwiHlrT" data-outputId="7782b107-17ee-4170-a1f2-8f2630cc98f4">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">--</span>upgrade scikit<span class="op">-</span>learn</span></code></pre></div>
<div class="output stream stdout">
<pre><code>WARNING: Ignoring invalid distribution -cikit-learn (/usr/local/lib/python3.10/dist-packages)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (1.4.2)
Requirement already satisfied: numpy&gt;=1.19.5 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.25.2)
Requirement already satisfied: scipy&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.11.4)
Requirement already satisfied: joblib&gt;=1.2.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn) (3.5.0)
WARNING: Ignoring invalid distribution -cikit-learn (/usr/local/lib/python3.10/dist-packages)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="114"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:389}"
id="ZjJA4hDXHjle" data-outputId="18897e90-8e6f-4e12-89d9-db766591042f">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming you have a trained model and test data</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>y_true <span class="op">=</span> y_test  <span class="co"># True labels of the test data</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_test)  <span class="co"># Predicted labels by the model</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confusion matrix</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confusion matrix using Seaborn</span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;g&#39;</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Confusion Matrix&#39;</span>)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True&#39;</span>)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step 
</code></pre>
</div>
<div class="output error" data-ename="ValueError"
data-evalue="Classification metrics can&#39;t handle a mix of multilabel-indicator and continuous-multioutput targets">
<pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-114-e569f53f13fa&gt; in &lt;cell line: 10&gt;()
      8 
      9 # Calculate the confusion matrix
---&gt; 10 cm = confusion_matrix(y_true, y_pred)
     11 
     12 # Plot the confusion matrix using Seaborn

/usr/local/lib/python3.10/dist-packages/sklearn/utils/_param_validation.py in wrapper(*args, **kwargs)
    211                     )
    212                 ):
--&gt; 213                     return func(*args, **kwargs)
    214             except InvalidParameterError as e:
    215                 # When the function is just a wrapper around an estimator, we allow

/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py in confusion_matrix(y_true, y_pred, labels, sample_weight, normalize)
    317     (0, 2, 1, 1)
    318     &quot;&quot;&quot;
--&gt; 319     y_type, y_true, y_pred = _check_targets(y_true, y_pred)
    320     if y_type not in (&quot;binary&quot;, &quot;multiclass&quot;):
    321         raise ValueError(&quot;%s is not supported&quot; % y_type)

/usr/local/lib/python3.10/dist-packages/sklearn/metrics/_classification.py in _check_targets(y_true, y_pred)
     92 
     93     if len(y_type) &gt; 1:
---&gt; 94         raise ValueError(
     95             &quot;Classification metrics can&#39;t handle a mix of {0} and {1} targets&quot;.format(
     96                 type_true, type_pred

ValueError: Classification metrics can&#39;t handle a mix of multilabel-indicator and continuous-multioutput targets
</code></pre>
</div>
</div>
<div class="cell markdown" id="4MMivSYCDo_p">
<p>final results:val_accuracy: 0.8462 - val_loss: 0.5145</p>
</div>
</body>
</html>
